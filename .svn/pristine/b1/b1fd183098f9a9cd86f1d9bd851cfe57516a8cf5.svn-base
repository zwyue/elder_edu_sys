<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">	
		<title>老年大学系统——用户管理</title>
		<link rel="stylesheet" href="plugins/layui-v2.4.3/layui/css/layui.css"/>
		<link rel="stylesheet" href="css/common_style.css" />
		<link rel="stylesheet" href="css/yhgl_xsgl.css" />

	</head>
	<body>

		<div id="bgDiv"></div>
		<!--新增学生弹窗-->
		<!--<div id="fgDiv" style="display: none;">  
            <input type="hidden" id="hidId"/>
            <section>
            	<label>序 号:</label><input type="text" id="num2"/>
            </section>
            <section>
            	<label>姓名:</label><input type="text" id="name2"/>
            </section>
            <section>
            	<label>类别:</label><input type="text" id="leiBie2"/>
            </section>
            <section>
            	<label>类别:</label><input type="text" id="zhuanYe2"/>
            </section>
            <section>
            	<label>班级:</label><input type="text" id="banJi2"/>
            </section>
            <section>
            	<label>联系方式:</label><input type="text" id="tel2"/>
            </section>
            <section>
            	<label>家属联系方式:</label><input type="text" id="familyTel2"/>
            </section>
            <section>
            	<label>班主任:</label><input type="text" id="teacher2"/>
            </section>
            <button  class="layui-btn" id="btnSave">
                 	 保存
              </button>
              <button  class="layui-btn" id="close">
                 	 取消
              </button>
       </div>			-->
		<!--新增学生弹窗 end-->
		
<!--查看表格弹窗-->
	<!--<div id="fgDivLook">
        <form class="layui-form" style="padding-top: 20px;box-sizing: border-box;">
        	<input type="hidden" id="hidId1"/>
          <div class="layui-form-item">
		    <div class="layui-inline">
		      <label class="layui-form-label">序号：</label>
		      <div class="layui-input-inline">
		        <input type="text"  class="layui-input" id="num1" disabled="disabled"/>
		      </div>
		    </div>
		    <div class="layui-inline">
		      <label class="layui-form-label">姓名：</label>
		      <div class="layui-input-inline">
		        <input type="text" class="layui-input" id="name1" disabled="disabled"/>
		      </div>
		    </div>			    
		  </div>
          <div class="layui-form-item">
		    <div class="layui-inline">
		      <label class="layui-form-label">类别：</label>
		      <div class="layui-input-inline">
		        <input type="text"  class="layui-input" id="leiBie1" disabled="disabled"/>
		      </div>
		    </div>
		    <div class="layui-inline">
		      <label class="layui-form-label">专业：</label>
		      <div class="layui-input-inline">
		        <input type="text" class="layui-input" id="zhuanYe1" disabled="disabled"/>
		      </div>
		    </div>			    
		  </div>
         <div class="layui-form-item">
		    <div class="layui-inline">
		      <label class="layui-form-label">班级：</label>
		      <div class="layui-input-inline">
		        <input type="text"  class="layui-input" id="banJi1" disabled="disabled"/>
		      </div>
		    </div>
		    <div class="layui-inline">
		      <label class="layui-form-label">联系方式：</label>
		      <div class="layui-input-inline">
		        <input type="text" class="layui-input" id="tel1" disabled="disabled"/>
		      </div>
		    </div>			    
		  </div>
		  <div class="layui-form-item">
		    <div class="layui-inline">
		      <label class="layui-form-label">家属联系方式：</label>
		      <div class="layui-input-inline">
		        <input type="text"  class="layui-input" id="familyTel1" disabled="disabled"/>
		      </div>
		    </div>
		    <div class="layui-inline">
		      <label class="layui-form-label">班主任：</label>
		      <div class="layui-input-inline">
		        <input type="text" class="layui-input" id="teacher1" disabled="disabled"/>
		      </div>
		    </div>			    
		  </div>        
          <div class="layui-form-item">
              <label for="L_repass" class="layui-form-label">
              </label>
              <button  class="layui-btn" id="close1" style="margin-left: 200px;">
                 	 退出
              </button>
          </div>
      </form>
  </div>	-->
	<!--查看表格弹窗 end-->
		
		<!--用户管理内容-->
		<div class="layui-body yhglContent">
			<span class="layui-breadcrumb yhgl_nav">
			  <a href="javascript:;"><cite>用户管理</cite></a><span lay-separator="">＞</span>
			  <a href="javascript:;">老师管理</a>
			</span>			
			<!--查询-->
			<div class="layui-form chaXun">
			  <div class="layui-form-item">
			    <div class="layui-inline">
			      <label class="layui-form-label">姓名：</label>
			      <div class="layui-input-inline">
			        <input type="text" class="layui-input" id="name" >
			      </div>
			    </div>
			    <div class="layui-inline">
			      <label class="layui-form-label">身份证：</label>
			      <div class="layui-input-inline">
			        <input type="text" class="layui-input" id="idCard">
			      </div>
			    </div>
			    <a href="javascript:;" class="btn_chaXun fr" id="chaXun">查询</a>
			  </div>			  
			</div>
			<!--查询 end-->
			
			<!--表格-->
			<div class="biaoGe">
				<section >
					<span class="xslb_bt fl">老师列表</span>
					<a href="yhgl_lsgl_jsxz.html" class="xzxs fr" id="xzxs" >
						<i class="layui-icon layui-icon-add-1"></i>新增老师
					</a>
				</section>
				<!---数据表格-->
				<table class="layui-table" lay-skin="line" id="tb">
			      <thead>
			        <tr>
			          <th>序号</th>
			          <th>姓名</th>
			          <th>工作单位</th>
			          <th>年龄</th>
			          <th>教授专业</th>
			          <th>任职时间</th>
			          <th>操作</th>
			        </tr> 
			      </thead>
			    <tbody></tbody>
			    </table>
			    <p class="showPage">每页显示
			    	<select>
					  <option value ="volvo">5</option>
					  <option value ="saab">10</option>
					  <option value="opel">15</option>
					</select>
			        列</p>
				<!--数据表格 end-->
				
				<!--分页-->
			      <div class="page">
			        <div id="text1"></div>
			    </div>
			    <!--分页end-->
			</div>
			<!--表格end-->
		</div>
		<!--用户管理内容 end-->

		<script type="text/javascript" src="plugins/jQuery/jquery-3.3.1.js"></script>
		<script type="text/javascript" src="plugins/layui-v2.4.3/layui/layui.js"></script>
		<script type="text/javascript" src="js/dateUtil.js"></script>
		<!--<script src="js/yhgl_lsgl.js"></script>-->
		<script>
        $(function(){
            ajaxPLists();
        });
        function ajaxPLists(){
            //分页
            var pageNum = 0;//初始化页数为第一页
            var pageSize = 10;  //限定每页显示
            layui.use('laypage', function (){
                var laypage = layui.laypage;
                var totalRecord = 0;//初始化总记录数
                //每页显示条数7条
                getNewsData();

                function getNewsData(){
                    $.ajax({
                        type: "get",
                        async: false,
                        url: "http://192.168.0.146:8088/teacher/list",
                        xhrFields: {withCredentials: true}, 
                        data: {
                            pageNum: pageNum,
                            pageSize: pageSize
                        },
                        success: function (data){
                            totalRecord = data.data.total;//数据总条数
                            var html ="";             
                            $.each(data.data.list, function (i, item){
                            	//年龄和专业需要调整
                                var addTime = new Date(item.crttime).Format("yyyy-MM-dd");
                                html += '<tr>';
                                html += '<td>' + (i+1) + '</td>' +'<td>' + item.tname + '</td>' + '<td>' + item.workunit + '</td>' + '<td>' + item.age + '</td>' + '<td>' + item.majorname + '</td>' +'<td>' + addTime + '</td>'+'<td style="display:none">' + item.id + '</td>';
                                html += '<td class="td-manage">' +
                                    '<a title="删除" class="layui-btn layui-btn-xs layui-btn-danger" onclick="delTeacher('+item.id+')" lay-event="del" >删除</a>' +
                                    '<a title="编辑" class="layui-btn layui-btn-xs" onclick="member_edit('+item.id+')" lay-event="edit" >修改</a>' +
                                    '<a class="layui-btn layui-btn-xs layui-btn-primary" onclick="member_glfj('+item.id+')" >查看</a>' +
                                    '</td>';
                                html += '</tr>';
                            })
                            $('tbody').html(html);
                        },
                        error: function (){
                            console.log('请求列表错误');
                        }
                    });
                };
                //执行一个laypage实例
                laypage.render({
                    elem: 'text1' //注意，这里的 test1 是 ID，不用加 #号
                    , count: totalRecord //数据总数，从服务端得到
                    , curr: pageNum
                    , limit: pageSize
                    , jump: function (obj, first) {
                        //obj包含了当前分页的所有参数，比如：
                        pageNum = obj.curr;//得到当前页，以便向服务端请求对应页的数据。
                        pageSize = obj.limit;//得到每页显示的条数
                        //首次不执行，清除上一页数据
                        if (!first) {
                            //do something
                            $('tbody').empty();
                            getNewsData();
                        }
                    }
                });
            });
        };
//      function member_edit(id){
//          console.log(id);
//          x_admin_show('编辑','./spkc_wsp_edit.html?id='+id);
//      };
//      function member_look(id){
//          x_admin_show("查看",'./spkc_wsp_look.html?id='+id);
//      };
//
//
//      function member_glfj(id){
//          window.location.href="spkc_wsp_bjzj_list.html?id="+id;
//      };

        //删除数据
        function delTeacher(id){
            $.ajax({
                type: "get",
                async: false,
                xhrFields: {withCredentials: true}, 
                url: "http://192.168.0.146:8088/teacher/delete?id="+id,
                success: function(data){
                	layui.use('layer', function(){
						layer.confirm('确认要删除吗？', function(index){
                        //发异步删除数据
                        layer.msg('已删除!', {
                                icon: 1,
                                time: 1000
                            });
                        ajaxPLists();
                    });
					});
//					setTimeout(function(){
//						window.history.go(-1);
//					},800)	
//                  layer.confirm('确认要删除吗？', function(index){
//                      //发异步删除数据
//                      layer.msg('已删除!', {
//                              icon: 1,
//                              time: 1000
//                          });
//                      ajaxPLists();
//                  });
                },
                error: function(){
                    console.log('删除失败');
                }
            });
        };
    </script>
  
		<!--<script>
		//保存新增教师
		$(function(){
			$.ajax({
				type: "post",
				async: false,
				url: "http://192.168.0.146:8088/teacher/list",
				xhrFields: {withCredentials: true}, 
				
				success: function(data){					
					layui.use('layer', function(){
						var layer = layui.layer;
						layer.msg('新增成功');
					});
					setTimeout(function(){
						window.history.go(-1);
					},800)						
				},
				error: function(){
					layui.use('layer', function(){
							var layer = layui.layer;
							layer.msg('请求失败');
					});
				}
			});
		});
		</script>
	</body>-->
</html>
