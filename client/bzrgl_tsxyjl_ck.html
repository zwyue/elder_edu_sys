<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>老年大学系统——班主任日志套</title>
    <link rel="stylesheet" href="plugins/layui-v2.4.3/layui/css/layui.css"/>
    <link rel="stylesheet" href="css/common_style.css" />
    <link rel="stylesheet" href="font/iconfont.css"/>
    <link rel="stylesheet" href="css/bzrgl.css" />
    <link rel="stylesheet" href="css/bzrgl_tsxyjl_time.css" />
    <link rel="stylesheet" href="css/all.css" />
    <style>
        .layui-layer-content{
            width: 80%;
            padding-left: 5%; height: 270px; padding-top: 5%;
        }
    </style>

</head>
<body id="bzrgl">
    <!--特殊学员记录-修改 内容-->
    <div class="layui-body bzrglContent">
        <span class="layui-breadcrumb bzrgl_nav">
           <a href="javascript:;"><cite>班主任日志套</cite></a><span lay-separator="">></span>
           <a href="javascript:;"><cite>特殊学员记录</cite></a><span lay-separator="">></span>
           <a href="javascript:;"><cite>特殊学员查看</cite></a>
        </span>
        <!--内容部分-->
        <div class="content">
            <div class="content-head">
                <a class="title" href="javascript:;">特殊学员查看</a>
                <a href="javascript:history.go(-1);" class="fanHui backBtn">返回</a>
            </div>
            <div class="yd_information">
                <form class="layui-form" action="">
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">学生姓名：</label>
                            <div class="layui-input-inline">
                                <input type="text" name="name" id="stuName" onclick="xzstudent()" placeholder="请选择"
                                       autocomplete="off" class="layui-input">
                                <input type="hidden" id="stuNameValue">
                                <input type="hidden" id="linkType">
                                <input type="hidden" id="xuehao">
                                <input type="hidden" id="idCard">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">学生性别：</label>
                            <div class="layui-input-inline">
                                <select name="sex" id="stuSex">
                                    <option value="0">男</option>
                                    <option value="1">女</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">建档原因：</label>
                            <div class="layui-input-inline">
                                <select name="result" id="stuResult" class="layui-disabled">
                                    <option value="">请选择</option>
                                    <option value="0">退班</option>
                                    <option value="1">转班</option>
                                    <option value="2">休学</option>
                                    <option value="3">开除</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">退班班级：</label>
                            <div class="layui-input-inline">
                                <input type="text" onclick="tbclass()" name="tbClass" id="tbClass"
                                       placeholder="点击 出现弹窗退班" autocomplete="off" class="layui-input">
                                <input type="hidden" id="tbClassId">
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">主要原因：</label>
                            <div class="layui-input-inline">
                                <textarea name="desc" id="mainResult" placeholder="请输入内容"
                                          class="main_textarea layui-textarea"></textarea>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="">
                <div class="content-head2">
                    <a class="title" href="javascript:;">班主任填写意见</a>
                </div>
                <div class="yd_information">
                    <form class="layui-form" action="">
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">填写时间：</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="time" id="time" placeholder="选择时间" autocomplete="off"
                                           class="layui-input test-item">
                                </div>
                            </div>
                            <div class="layui-inline">
                                <label class="layui-form-label">填写地点：</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="area" id="area" placeholder="请输入" autocomplete="off"
                                           class="layui-input">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">辅导老师：</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="fdTeacher" id="fdTeacher" disabled placeholder="请输入"
                                           autocomplete="off" class="layui-input layui-disabled">
                                </div>
                            </div>
                            <div class="layui-inline">
                                <label class="layui-form-label">针对问题：</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="question" id="question" placeholder="请输入"
                                           autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">辅导意见：</label>
                                <div class="layui-input-inline">
                                    <textarea name="desc" id="fdMassage" placeholder="请输入内容"
                                              class="main_textarea layui-textarea"></textarea>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!--内容部分end-->
    </div>
    <!--特殊学员记录-修改 内容end-->


    <script src="plugins/jQuery/jquery-3.3.1.min.js"></script>
    <script src="plugins/layui-v2.4.3/layui/layui.js"></script>
    <script >

    //获取浏览地址id
    (function ($) {
        $.getUrlParam = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]);
            return null;
        }
    })(jQuery);
    var id = $.getUrlParam('id');
    // 查询到id，并把表格页面的值带到修改页面
    $(function () {
        $.ajax({
            type: 'GET',
            url: "api/specialmanager/query",
            async: false,
            data: {
                id: id
            },
            dataType: 'json',
            xhrFields: {withCredentials: true},
            success: function (data) {
                $("#stuName").val(data.data.sname);
                $("#stuNameValue").val(data.data.sid);
                $("#linkType").val(data.data.phone);
                $("#xuehao").val(data.data.stunumber);
                $("#stuSex").val(data.data.sex);
                $("#stuResult").val(data.data.types);
                $("#tbClass").val(data.data.classname);
                $("#tbClassId").val(data.data.classid);
                $("#mainResult").val(data.data.content);
                $("#time").val(data.data.filtime);
                $("#area").val(data.data.address);
                $("#question").val(data.data.question);
                $("#fdMassage").val(data.data.options);
                $("#idCard").val(data.data.idcard);
                $('input').attr("disabled",true).addClass("layui-disabled");
                $('textarea').attr("disabled",true).addClass("layui-disabled");
                $('select').attr("disabled",true).addClass("layui-disabled");
            },
            error: function(error) {
                layui.use('layer', function () {
                    var layer = layui.layer;
                    layer.msg(error.responseText);
                });
            }
        });
    });
    $(function () {
        var username = $("#user", parent.parent.document).text();
        var teacher = username.substr(3);
        $("#fdTeacher").val(teacher);
    })
    //from表单select 通用
    layui.use('form', function(){
        var form = layui.form;
    });
    //时间控件
    layui.use('laydate', function(){
        var laydate = layui.laydate;
        lay('.test-item').each(function(){
            laydate.render({
                elem:this
                ,type: 'datetime'
            });
        });

    });

    //新增选择学生弹窗
    function xzstudent() {
        $.ajax({
            type: 'get',
            url: "api/common/judge",
            async: false,
            dataType: 'json',
            xhrFields: {withCredentials: true},
            success: function (data) {
                if (data.data == 0) {
                    //身份为校长-学生姓名弹窗
                    layer.open({
                        title: '选择学生',
                        type: 2,
                        area: ['500px', '400px'],
                        fixed: false, //不固定
                        maxmin: true, //开启最大化最小化按钮
                        content: 'bzrgl_tsxyjl_xz_name_alert.html',
                        btn: ['确定', '取消'],
                        yes: function (index, layero) {//该回调携带两个参数，分别为当前层索引、当前层DOM对象
                            //当点击‘确定’按钮的时候，获取弹出层返回的值
                            var res = window["layui-layer-iframe" + index].callbackdata();
                            $("#stuName").val(res.username);
                            $("#stuNameValue").val(res.usernameid);
                            //判断选择学生姓名是否正确
                            var studentName=$("#stuName").val();
                            if(studentName=='请选择'){
                                layui.use('layer', function () {
                                    var layer = layui.layer;
                                    layer.alert('请选择学生', {area: ['200px','180px']});
                                });
                                return false;
                            }
                            //联系方式和学号,身份证
                            $("#linkType").val(res.link);
                            $("#xuehao").val(res.xuehao);
                            $("#idCard").val(res.idCard);
                            //最后关闭弹出层
                            layer.close(index);
                        }
                        , btn2: function (index, layero) {

                        }
                    });
                }
                else if(data.data==1){
                    //身份为班主任-新增学生姓名弹窗
                    layer.open({
                        title: '选择学生',
                        type: 2,
                        area: ['500px', '400px'],
                        fixed: false, //不固定
                        maxmin: true, //开启最大化最小化按钮
                        content: 'bzrgl_tsxyjl_xz_name_alert2.html',
                        btn: ['确定', '取消'],
                        yes: function (index, layero) {//该回调携带两个参数，分别为当前层索引、当前层DOM对象
                            //当点击‘确定’按钮的时候，获取弹出层返回的值
                            var res = window["layui-layer-iframe" + index].callbackdata();

                            $("#stuName").val(res.username);
                            $("#stuNameValue").val(res.usernameid);
                            //判断选择学生姓名是否正确
                            var studentName=$("#stuName").val();
                            if(studentName=='请选择'){
                                layui.use('layer', function () {
                                    var layer = layui.layer;
                                    layer.alert('请选择学生', {area: ['200px','180px']});
                                });
                                return false;
                            }
                            //联系方式和学号,身份证
                            $("#linkType").val(res.link);
                            $("#xuehao").val(res.xuehao);
                            $("#idCard").val(res.idCard);
                            //最后关闭弹出层
                            layer.close(index);
                        }
                        , btn2: function (index, layero) {

                        }
                    });
                }
            }
        })
    }
    //选择退班班级弹窗
    function tbclass() {
        $.ajax({
            type: 'get',
            url: "api/common/judge",
            async: false,
            dataType: 'json',
            xhrFields: {withCredentials: true},
            success: function (data) {
                if (data.data == 0) {
                    //身份为校长-退班班级弹窗
                    layer.open({
                        title: '选择班级',
                        type: 2,
                        area: ['500px', '400px'],
                        fixed: false, //不固定
                        maxmin: true, //开启最大化最小化按钮
                        content: 'bzrgl_tsxyjl_xz_tuiban_alert.html',
                        btn: ['确定', '取消'],
                        yes: function (index, layero) {//该回调携带两个参数，分别为当前层索引、当前层DOM对象
                            //当点击‘确定’按钮的时候，获取弹出层返回的值
                            var res = window["layui-layer-iframe" + index].callbackdata();

                            $("#tbClass").val(res.username);
                            $("#tbClassId").val(res.usernameid);
                            //判断选择学生姓名是否正确
                            var studentClass=$("#tbClass").val();
                            if(studentClass=='请选择'){
                                layui.use('layer', function () {
                                    var layer = layui.layer;
                                    layer.alert('请选择班级', {area: ['200px','180px']});
                                });
                                return false;
                            }
                            //最后关闭弹出层
                            layer.close(index);
                        }
                        , btn2: function (index, layero) {

                        }
                    })
                }
                else if (data.data == 1) {
                    //身份为班主任-退班班级弹窗
                    layer.open({
                        title: '选择班级',
                        type: 2,
                        area: ['500px', '400px'],
                        fixed: false, //不固定
                        maxmin: true, //开启最大化最小化按钮
                        content: 'bzrgl_tsxyjl_xz_tuiban_alert2.html',
                        btn: ['确定', '取消'],
                        yes: function (index, layero) {//该回调携带两个参数，分别为当前层索引、当前层DOM对象
                            //当点击‘确定’按钮的时候，获取弹出层返回的值
                            var res = window["layui-layer-iframe" + index].callbackdata();

                            $("#tbClass").val(res.username);
                            $("#tbClassId").val(res.usernameid);
                            //判断选择学生姓名是否正确
                            var studentClass=$("#tbClass").val();
                            if(studentClass=='请选择'){
                                layui.use('layer', function () {
                                    var layer = layui.layer;
                                    layer.alert('请选择班级', {area: ['200px','180px']});
                                });
                                return false;
                            }
                            //最后关闭弹出层
                            layer.close(index);
                        }
                        , btn2: function (index, layero) {

                        }
                    })
                }
            }
        })
    }
    </script>


</body>
</html>